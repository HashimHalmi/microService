<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Cart</title>-->
<!--    <style>-->
<!--        table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--        }-->

<!--        table, th, td {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        th, td {-->
<!--            padding: 10px;-->
<!--            text-align: left;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Shopping Cart</h1>-->

<!--&lt;!&ndash; Form for adding products to the cart &ndash;&gt;-->
<!--<h2>Add Product</h2>-->
<!--<form id="addProductForm">-->
<!--    <label for="product_id">Product ID:</label>-->
<!--    <input type="text" id="product_id" required>-->
<!--    <br>-->
<!--    <label for="quantity">Quantity:</label>-->
<!--    <input type="number" id="quantity" required>-->
<!--    <br>-->
<!--    <label for="price">Price:</label>-->
<!--    <input type="number" step="0.01" id="price" required>-->
<!--    <br>-->
<!--    <button type="submit">Add to Cart</button>-->
<!--</form>-->

<!--&lt;!&ndash; Display cart items &ndash;&gt;-->
<!--<h2>Cart Items</h2>-->
<!--<div id="cart">-->
<!--    <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th>Product ID</th>-->
<!--            <th>Quantity</th>-->
<!--            <th>Price</th>-->
<!--            <th>Total</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="cartItems">-->
<!--        &lt;!&ndash; Cart items will be appended here &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<button id="clearCart">Clear Cart</button>-->
<!--<button id="checkout">Checkout</button>-->
<!--<button id="proceedToPayment">Proceed to Payment</button> &lt;!&ndash; New button for payment &ndash;&gt;-->
<!--<button id="deleteLastTransaction">Delete Last Transaction</button> &lt;!&ndash; New button for deleting last transaction &ndash;&gt;-->
<!--<button id="viewTransactions">View Transactions</button> &lt;!&ndash; New button for viewing transactions &ndash;&gt;-->

<!--<script>-->
<!--    function fetchCart() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for fetchCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart', {-->
<!--            method: 'GET',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                response.json().then(data => {-->
<!--                    console.log('Cart data:', data);  // Логирование данных корзины-->
<!--                    const cartItems = document.getElementById('cartItems');-->
<!--                    cartItems.innerHTML = '';-->

<!--                    const items = data.Items || data.items;-->
<!--                    let grandTotal = 0; // Инициализация общей суммы-->

<!--                    if (items && Array.isArray(items)) {-->
<!--                        items.forEach(item => {-->
<!--                            const total = item.quantity * item.price;-->
<!--                            grandTotal += total; // Добавление к общей сумме-->

<!--                            const row = document.createElement('tr');-->
<!--                            row.innerHTML = `-->
<!--                                <td>${item.product_id}</td>-->
<!--                                <td>${item.quantity}</td>-->
<!--                                <td>${item.price.toFixed(2)}</td>-->
<!--                                <td>${total.toFixed(2)}</td>-->
<!--                            `;-->
<!--                            cartItems.appendChild(row);-->
<!--                        });-->

<!--                        // Добавление строки с общей суммой в конец таблицы-->
<!--                        const totalRow = document.createElement('tr');-->
<!--                        totalRow.innerHTML = `-->
<!--                            <td colspan="3"><strong>Total</strong></td>-->
<!--                            <td><strong>${grandTotal.toFixed(2)}</strong></td>-->
<!--                        `;-->
<!--                        cartItems.appendChild(totalRow);-->
<!--                    } else {-->
<!--                        console.error('Unexpected cart data format:', data);-->
<!--                    }-->
<!--                });-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to fetch cart:', text);-->
<!--                    alert('Failed to fetch cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error fetching cart:', error);-->
<!--            alert('Failed to fetch cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    document.getElementById('addProductForm').addEventListener('submit', function(event) {-->
<!--        event.preventDefault();-->
<!--        const productId = document.getElementById('product_id').value;-->
<!--        const quantity = parseInt(document.getElementById('quantity').value);-->
<!--        const price = parseFloat(document.getElementById('price').value);-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for addProduct:', token);  // Логирование токена-->
<!--        console.log('Product ID:', productId);  // Логирование ID продукта-->

<!--        fetch('/api/cart/add', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                product_id: productId,-->
<!--                quantity: quantity,-->
<!--                price: price-->
<!--            })-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Product added to cart!');-->
<!--                fetchCart(); // Обновление корзины после добавления продукта-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to add product to cart:', text);-->
<!--                    alert('Failed to add product to cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error adding product to cart:', error);-->
<!--            alert('Failed to add product to cart: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('clearCart').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for clearCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart/clear', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Cart cleared!');-->
<!--                fetchCart(); // Обновление корзины после очистки-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to clear cart:', text);-->
<!--                    alert('Failed to clear cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error clearing cart:', error);-->
<!--            alert('Failed to clear cart: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('checkout').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for checkout:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/checkout', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Checkout successful!');-->
<!--                fetchCart(); // Обновление корзины после оформления заказа-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Checkout failed:', text);-->
<!--                    alert('Checkout failed: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error during checkout:', error);-->
<!--            alert('Checkout failed: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('proceedToPayment').addEventListener('click', function() {-->
<!--        window.location.href = 'payment.html'; // Переход на страницу оплаты-->
<!--    });-->

<!--    document.getElementById('viewTransactions').addEventListener('click', function() {-->
<!--        window.location.href = 'transactions.html'; // Переход на страницу транзакций-->
<!--    });-->

<!--    document.getElementById('deleteLastTransaction').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for deleteLastTransaction:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/deleteLast', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Last transaction deleted!');-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to delete last transaction:', text);-->
<!--                    alert('Failed to delete last transaction: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error deleting last transaction:', error);-->
<!--            alert('Failed to delete last transaction: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    window.onload = fetchCart;-->
<!--</script>-->

<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Cart</title>-->
<!--    <style>-->
<!--        table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--        }-->

<!--        table, th, td {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        th, td {-->
<!--            padding: 10px;-->
<!--            text-align: left;-->
<!--        }-->

<!--        .product-container {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 20px;-->
<!--        }-->

<!--        .product {-->
<!--            border: 1px solid #ddd;-->
<!--            padding: 10px;-->
<!--            text-align: center;-->
<!--            width: 150px;-->
<!--        }-->

<!--        .product img {-->
<!--            max-width: 100%;-->
<!--        }-->

<!--        .product button {-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .product-details {-->
<!--            display: none;-->
<!--            margin-top: 10px;-->
<!--            text-align: left;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Shopping Cart</h1>-->

<!--&lt;!&ndash; Product Images and Buttons &ndash;&gt;-->
<!--<h2>Products</h2>-->
<!--<div class="product-container">-->
<!--    <div class="product">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Glass_of_Milk_%2833657535532%29.jpg/274px-Glass_of_Milk_%2833657535532%29.jpg" alt="Milk">-->
<!--        <button onclick="addToCart('1', 'Product 1', 110)">Add to Cart</button>-->
<!--    </div>-->
<!--    <div class="product">-->
<!--        <img src="path/to/image2.jpg" alt="Bread">-->
<!--        <button onclick="addToCart('2', 'Product 2', 165)">Add to Cart</button>-->
<!--    </div>-->
<!--    <div class="product">-->
<!--        <img src="path/to/image2.jpg" alt="Tea">-->
<!--        <button onclick="addToCart('2', 'Product 2', 165)">Add to Cart</button>-->
<!--    </div>-->
<!--    &lt;!&ndash; Add more products as needed &ndash;&gt;-->
<!--</div>-->

<!--&lt;!&ndash; Display cart items &ndash;&gt;-->
<!--<h2>Cart Items</h2>-->
<!--<div id="cart">-->
<!--    <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th>Product ID</th>-->
<!--            <th>Product Name</th>-->
<!--            <th>Quantity</th>-->
<!--            <th>Price</th>-->
<!--            <th>Total</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="cartItems">-->
<!--        &lt;!&ndash; Cart items will be appended here &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<button id="clearCart">Clear Cart</button>-->
<!--<button id="checkout">Checkout</button>-->
<!--<button id="proceedToPayment">Proceed to Payment</button> &lt;!&ndash; New button for payment &ndash;&gt;-->
<!--<button id="deleteLastTransaction">Delete Last Transaction</button> &lt;!&ndash; New button for deleting last transaction &ndash;&gt;-->
<!--<button id="viewTransactions">View Transactions</button> &lt;!&ndash; New button for viewing transactions &ndash;&gt;-->

<!--<script>-->
<!--    function addToCart(productId, productName, price) {-->
<!--        const quantity = 1;  // Default quantity-->

<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for addToCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart/add', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                product_id: productId,-->
<!--                product_name: productName,-->
<!--                quantity: quantity,-->
<!--                price: price-->
<!--            })-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Product added to cart!');-->
<!--                fetchCart(); // Обновление корзины после добавления продукта-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to add product to cart:', text);-->
<!--                    alert('Failed to add product to cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error adding product to cart:', error);-->
<!--            alert('Failed to add product to cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    function fetchCart() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for fetchCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart', {-->
<!--            method: 'GET',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                response.json().then(data => {-->
<!--                    console.log('Cart data:', data);  // Логирование данных корзины-->
<!--                    const cartItems = document.getElementById('cartItems');-->
<!--                    cartItems.innerHTML = '';-->

<!--                    const items = data.Items || data.items;-->
<!--                    let grandTotal = 0; // Инициализация общей суммы-->

<!--                    if (items && Array.isArray(items)) {-->
<!--                        items.forEach(item => {-->
<!--                            const total = item.quantity * item.price;-->
<!--                            grandTotal += total; // Добавление к общей сумме-->

<!--                            const row = document.createElement('tr');-->
<!--                            row.innerHTML = `-->
<!--                                <td>${item.product_id}</td>-->
<!--                                <td>${item.product_name}</td>-->
<!--                                <td>${item.quantity}</td>-->
<!--                                <td>${item.price.toFixed(2)}</td>-->
<!--                                <td>${total.toFixed(2)}</td>-->
<!--                            `;-->
<!--                            cartItems.appendChild(row);-->
<!--                        });-->

<!--                        // Добавление строки с общей суммой в конец таблицы-->
<!--                        const totalRow = document.createElement('tr');-->
<!--                        totalRow.innerHTML = `-->
<!--                            <td colspan="4"><strong>Total</strong></td>-->
<!--                            <td><strong>${grandTotal.toFixed(2)}</strong></td>-->
<!--                        `;-->
<!--                        cartItems.appendChild(totalRow);-->
<!--                    } else {-->
<!--                        console.error('Unexpected cart data format:', data);-->
<!--                    }-->
<!--                });-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to fetch cart:', text);-->
<!--                    alert('Failed to fetch cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error fetching cart:', error);-->
<!--            alert('Failed to fetch cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    document.getElementById('clearCart').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for clearCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart/clear', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Cart cleared!');-->
<!--                fetchCart(); // Обновление корзины после очистки-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to clear cart:', text);-->
<!--                    alert('Failed to clear cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error clearing cart:', error);-->
<!--            alert('Failed to clear cart: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('checkout').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for checkout:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/checkout', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Checkout successful!');-->
<!--                fetchCart(); // Обновление корзины после оформления заказа-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Checkout failed:', text);-->
<!--                    alert('Checkout failed: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error during checkout:', error);-->
<!--            alert('Checkout failed: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('proceedToPayment').addEventListener('click', function() {-->
<!--        window.location.href = 'payment.html'; // Переход на страницу оплаты-->
<!--    });-->

<!--    document.getElementById('viewTransactions').addEventListener('click', function() {-->
<!--        window.location.href = 'transactions.html'; // Переход на страницу транзакций-->
<!--    });-->

<!--    document.getElementById('deleteLastTransaction').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for deleteLastTransaction:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/deleteLast', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Last transaction deleted!');-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to delete last transaction:', text);-->
<!--                    alert('Failed to delete last transaction: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error deleting last transaction:', error);-->
<!--            alert('Failed to delete last transaction: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    window.onload = fetchCart;-->
<!--</script>-->

<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Cart</title>-->
<!--    <style>-->
<!--        table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--        }-->

<!--        table, th, td {-->
<!--            border: 1px solid black;-->
<!--        }-->

<!--        th, td {-->
<!--            padding: 10px;-->
<!--            text-align: left;-->
<!--        }-->

<!--        .product-container {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 20px;-->
<!--        }-->

<!--        .product {-->
<!--            border: 1px solid #ddd;-->
<!--            padding: 10px;-->
<!--            text-align: center;-->
<!--            width: 150px;-->
<!--        }-->

<!--        .product img {-->
<!--            max-width: 100%;-->
<!--        }-->

<!--        .product button, .product input {-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .quantity-container {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 10px;-->
<!--            margin-top: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Shopping Cart</h1>-->

<!--&lt;!&ndash; Product Images and Buttons &ndash;&gt;-->
<!--<h2>Products</h2>-->
<!--<div class="product-container">-->
<!--    <div class="product" data-product-id="1" data-product-name="Milk" data-product-price="110">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Glass_of_Milk_%2833657535532%29.jpg/274px-Glass_of_Milk_%2833657535532%29.jpg" alt="Milk">-->
<!--        <div>Milk</div>-->
<!--        <button onclick="addToCart(this)">Add to Cart</button>-->
<!--        <div class="quantity-container" style="display: none;">-->
<!--            <input type="number" min="1" value="1">-->
<!--            <button onclick="confirmQuantity(this)">Confirm</button>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="product" data-product-id="2" data-product-name="Bread" data-product-price="165">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Assorted_bread.jpg/411px-Assorted_bread.jpg" alt="Bread">-->
<!--        <div>Bread</div>-->
<!--        <button onclick="addToCart(this)">Add to Cart</button>-->
<!--        <div class="quantity-container" style="display: none;">-->
<!--            <input type="number" min="1" value="1">-->
<!--            <button onclick="confirmQuantity(this)">Confirm</button>-->
<!--        </div>-->
<!--    </div>-->
<!--    &lt;!&ndash; Add more products as needed &ndash;&gt;-->
<!--</div>-->

<!--&lt;!&ndash; Display cart items &ndash;&gt;-->
<!--<h2>Cart Items</h2>-->
<!--<div id="cart">-->
<!--    <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th>Product ID</th>-->
<!--            <th>Product Name</th>-->
<!--            <th>Quantity</th>-->
<!--            <th>Price</th>-->
<!--            <th>Total</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="cartItems">-->
<!--        &lt;!&ndash; Cart items will be appended here &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<button id="clearCart">Clear Cart</button>-->
<!--<button id="checkout">Checkout</button>-->
<!--<button id="proceedToPayment">Proceed to Payment</button> &lt;!&ndash; New button for payment &ndash;&gt;-->
<!--<button id="deleteLastTransaction">Delete Last Transaction</button> &lt;!&ndash; New button for deleting last transaction &ndash;&gt;-->
<!--<button id="viewTransactions">View Transactions</button> &lt;!&ndash; New button for viewing transactions &ndash;&gt;-->

<!--<script>-->
<!--    function addToCart(button) {-->
<!--        const productElement = button.closest('.product');-->
<!--        const quantityContainer = productElement.querySelector('.quantity-container');-->
<!--        button.style.display = 'none';-->
<!--        quantityContainer.style.display = 'flex';-->
<!--    }-->

<!--    function confirmQuantity(button) {-->
<!--        const quantityContainer = button.closest('.quantity-container');-->
<!--        const quantityInput = quantityContainer.querySelector('input');-->
<!--        const quantity = parseInt(quantityInput.value);-->
<!--        const productElement = button.closest('.product');-->

<!--        const productId = productElement.getAttribute('data-product-id');-->
<!--        const productName = productElement.getAttribute('data-product-name');-->
<!--        const price = parseFloat(productElement.getAttribute('data-product-price'));-->

<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for addToCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart/add', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                product_id: productId,-->
<!--                product_name: productName,-->
<!--                quantity: quantity,-->
<!--                price: price-->
<!--            })-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Product added to cart!');-->
<!--                fetchCart(); // Обновление корзины после добавления продукта-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to add product to cart:', text);-->
<!--                    alert('Failed to add product to cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error adding product to cart:', error);-->
<!--            alert('Failed to add product to cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    function fetchCart() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for fetchCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart', {-->
<!--            method: 'GET',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                response.json().then(data => {-->
<!--                    console.log('Cart data:', data);  // Логирование данных корзины-->
<!--                    const cartItems = document.getElementById('cartItems');-->
<!--                    cartItems.innerHTML = '';-->

<!--                    const items = data.Items || data.items;-->
<!--                    let grandTotal = 0; // Инициализация общей суммы-->

<!--                    if (items && Array.isArray(items)) {-->
<!--                        items.forEach(item => {-->
<!--                            const total = item.quantity * item.price;-->
<!--                            grandTotal += total; // Добавление к общей сумме-->

<!--                            const row = document.createElement('tr');-->
<!--                            row.innerHTML = `-->
<!--                                <td>${item.product_id}</td>-->
<!--                                <td>${item.product_name}</td>-->
<!--                                <td>${item.quantity}</td>-->
<!--                                <td>${item.price.toFixed(2)}</td>-->
<!--                                <td>${total.toFixed(2)}</td>-->
<!--                            `;-->
<!--                            cartItems.appendChild(row);-->
<!--                        });-->

<!--                        // Добавление строки с общей суммой в конец таблицы-->
<!--                        const totalRow = document.createElement('tr');-->
<!--                        totalRow.innerHTML = `-->
<!--                            <td colspan="4"><strong>Total</strong></td>-->
<!--                            <td><strong>${grandTotal.toFixed(2)}</strong></td>-->
<!--                        `;-->
<!--                        cartItems.appendChild(totalRow);-->
<!--                    } else {-->
<!--                        console.error('Unexpected cart data format:', data);-->
<!--                    }-->
<!--                });-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to fetch cart:', text);-->
<!--                    alert('Failed to fetch cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error fetching cart:', error);-->
<!--            alert('Failed to fetch cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    document.getElementById('clearCart').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for clearCart:', token);  // Логирование токена-->

<!--        fetch('/api/cart/clear', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Cart cleared!');-->
<!--                fetchCart(); // Обновление корзины после очистки-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to clear cart:', text);-->
<!--                    alert('Failed to clear cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error clearing cart:', error);-->
<!--            alert('Failed to clear cart: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('checkout').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for checkout:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/checkout', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Checkout successful!');-->
<!--                fetchCart(); // Обновление корзины после оформления заказа-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Checkout failed:', text);-->
<!--                    alert('Checkout failed: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error during checkout:', error);-->
<!--            alert('Checkout failed: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('proceedToPayment').addEventListener('click', function() {-->
<!--        window.location.href = 'payment.html'; // Переход на страницу оплаты-->
<!--    });-->

<!--    document.getElementById('viewTransactions').addEventListener('click', function() {-->
<!--        window.location.href = 'transactions.html'; // Переход на страницу транзакций-->
<!--    });-->

<!--    document.getElementById('deleteLastTransaction').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for deleteLastTransaction:', token);  // Логирование токена-->

<!--        fetch('/api/transaction/deleteLast', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                alert('Last transaction deleted!');-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to delete last transaction:', text);-->
<!--                    alert('Failed to delete last transaction: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error deleting last transaction:', error);-->
<!--            alert('Failed to delete last transaction: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    window.onload = fetchCart;-->
<!--</script>-->

<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Cart</title>-->
<!--    <style>-->
<!--        body {-->
<!--            font-family: Arial, sans-serif;-->
<!--            margin: 0;-->
<!--            padding: 20px;-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--            align-items: center;-->
<!--            background: linear-gradient(120deg, #f6d365 0%, #fda085 100%);-->
<!--        }-->

<!--        h1, h2 {-->
<!--            color: #333;-->
<!--        }-->

<!--        table {-->
<!--            width: 80%;-->
<!--            margin: 20px 0;-->
<!--            border-collapse: collapse;-->
<!--            background-color: #fff;-->
<!--            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);-->
<!--        }-->

<!--        table, th, td {-->
<!--            border: 1px solid #ddd;-->
<!--        }-->

<!--        th, td {-->
<!--            padding: 15px;-->
<!--            text-align: left;-->
<!--        }-->

<!--        th {-->
<!--            background-color: #f8f8f8;-->
<!--            font-weight: bold;-->
<!--        }-->

<!--        td {-->
<!--            background-color: #fafafa;-->
<!--        }-->

<!--        .product-container {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 20px;-->
<!--            justify-content: center;-->
<!--            margin: 20px 0;-->
<!--        }-->

<!--        .product {-->
<!--            border: 1px solid #ddd;-->
<!--            padding: 20px;-->
<!--            background-color: #fff;-->
<!--            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);-->
<!--            text-align: center;-->
<!--            width: 200px;-->
<!--            border-radius: 5px;-->
<!--        }-->

<!--        .product img {-->
<!--            max-width: 100%;-->
<!--            height: auto;-->
<!--        }-->

<!--        .product button, .product input {-->
<!--            margin-top: 10px;-->
<!--            padding: 10px;-->
<!--            border: none;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--            font-size: 14px;-->
<!--        }-->

<!--        .product button {-->
<!--            background-color: #28a745;-->
<!--            color: white;-->
<!--        }-->


<!--        .product .confirm-btn {-->
<!--            background-color: #007bff;-->
<!--            color: white;-->
<!--        }-->

<!--        .product input {-->
<!--            width: 60px;-->
<!--            text-align: center;-->
<!--        }-->

<!--        .quantity-container {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 10px;-->
<!--            margin-top: 10px;-->
<!--            justify-content: center;-->
<!--        }-->

<!--        .quantity-container input {-->
<!--            padding: 5px;-->
<!--            border: 1px solid #ddd;-->
<!--            border-radius: 5px;-->
<!--        }-->

<!--        .cart-buttons {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            margin-top: 20px;-->
<!--        }-->

<!--        .cart-buttons button {-->
<!--            padding: 10px 20px;-->
<!--            border: none;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--            background-color: #007bff;-->
<!--            color: white;-->
<!--            font-size: 14px;-->
<!--            transition: background-color 0.3s;-->
<!--        }-->

<!--        .cart-buttons button:hover {-->
<!--            background-color: #0056b3;-->
<!--        }-->

<!--        .cart-buttons button:active {-->
<!--            background-color: #003f7f;-->
<!--        }-->

<!--        .cart-buttons .clear-btn {-->
<!--            background-color: #dc3545;-->
<!--        }-->

<!--        .cart-buttons .clear-btn:hover {-->
<!--            background-color: #c82333;-->
<!--        }-->

<!--        .cart-buttons .clear-btn:active {-->
<!--            background-color: #bd2130;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Shopping Cart</h1>-->

<!--&lt;!&ndash; Product Images and Buttons &ndash;&gt;-->
<!--<h2>Products</h2>-->
<!--<div class="product-container">-->
<!--    <div class="product" data-product-id="1" data-product-name="Bread" data-product-price="110">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Assorted_bread.jpg/411px-Assorted_bread.jpg" alt="Bread">-->
<!--        <div>Bread</div>-->
<!--        <div class="quantity-container">-->
<!--            <input type="number" min="1" value="1">-->
<!--            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="product" data-product-id="2" data-product-name="Milk" data-product-price="165">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Glass_of_Milk_%2833657535532%29.jpg/411px-Glass_of_Milk_%2833657535532%29.jpg" alt="Milk">-->
<!--        <div>Milk</div>-->
<!--        <div class="quantity-container">-->
<!--            <input type="number" min="1" value="1">-->
<!--            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="product" data-product-id="3" data-product-name="Chocolate" data-product-price="320">-->
<!--        <img src="https://upload.wikimedia.org/wikipedia/ru/thumb/9/93/Mars_Max_J.P.jpg/270px-Mars_Max_J.P.jpg" alt="Chocolate">-->
<!--        <div>Chocolate</div>-->
<!--        <div class="quantity-container">-->
<!--            <input type="number" min="1" value="1">-->
<!--            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Display cart items &ndash;&gt;-->
<!--<h2>Cart Items</h2>-->
<!--<div id="cart">-->
<!--    <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th>Product ID</th>-->
<!--            <th>Product Name</th>-->
<!--            <th>Quantity</th>-->
<!--            <th>Price</th>-->
<!--            <th>Total</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody id="cartItems">-->
<!--        &lt;!&ndash; Cart items will be appended here &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<div class="cart-buttons">-->
<!--    <button id="clearCart" class="clear-btn">Clear Cart</button>-->
<!--    <button id="checkout" class="checkout-btn">Checkout</button>-->
<!--    <button id="proceedToPayment" class="payment-btn">Proceed to Payment</button>-->
<!--    <button id="deleteLastTransaction" class="transaction-btn">Delete Last Transaction</button>-->
<!--    <button id="viewTransactions" class="transaction-btn">View Transactions</button>-->
<!--</div>-->

<!--<script>-->
<!--    let cart = []; // Initialize an empty array to store cart items-->

<!--    // Map to store product names by product ID-->
<!--    const productNames = {-->
<!--        1: "Bread",-->
<!--        2: "Milk",-->
<!--        3: "Chocolate"-->
<!--    };-->

<!--    function addToCart(button) {-->
<!--        const productElement = button.closest('.product');-->
<!--        const quantityInput = productElement.querySelector('input');-->
<!--        const quantity = parseInt(quantityInput.value);-->

<!--        const productId = productElement.getAttribute('data-product-id');-->
<!--        const productName = productElement.getAttribute('data-product-name');-->
<!--        const price = parseFloat(productElement.getAttribute('data-product-price'));-->

<!--        // Add the product details to the cart array-->
<!--        cart.push({-->
<!--            product_id: productId,-->
<!--            product_name: productName,-->
<!--            quantity: quantity,-->
<!--            price: price-->
<!--        });-->

<!--        updateCart(); // Update the cart visually-->

<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for addToCart:', token);  // Logging the token-->

<!--        fetch('/api/cart/add', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                product_id: productId,-->
<!--                quantity: quantity,-->
<!--                price: price-->
<!--            })-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                console.log('Product added to cart!');-->
<!--                fetchCart(); // Refresh the cart after adding a product-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to add product to cart:', text);-->
<!--                    alert('Failed to add product to cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error adding product to cart:', error);-->
<!--            alert('Failed to add product to cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    function updateCart() {-->
<!--        const cartItems = document.getElementById('cartItems');-->
<!--        cartItems.innerHTML = ''; // Clear the current cart items-->

<!--        let grandTotal = 0; // Initialize the grand total-->

<!--        cart.forEach(item => {-->
<!--            const total = item.quantity * item.price;-->
<!--            grandTotal += total; // Add to the grand total-->

<!--            const row = document.createElement('tr');-->
<!--            row.innerHTML = `-->
<!--                <td>${item.product_id}</td>-->
<!--                <td>${productNames[item.product_id]}</td>-->
<!--                <td>${item.quantity}</td>-->
<!--                <td>${item.price.toFixed(2)}</td>-->
<!--                <td>${total.toFixed(2)}</td>-->
<!--            `;-->
<!--            cartItems.appendChild(row);-->
<!--        });-->

<!--        // Add a row for the grand total-->
<!--        const totalRow = document.createElement('tr');-->
<!--        totalRow.innerHTML = `-->
<!--            <td colspan="4"><strong>Total</strong></td>-->
<!--            <td><strong>${grandTotal.toFixed(2)}</strong></td>-->
<!--        `;-->
<!--        cartItems.appendChild(totalRow);-->
<!--    }-->

<!--    function fetchCart() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for fetchCart:', token);  // Logging the token-->

<!--        fetch('/api/cart', {-->
<!--            method: 'GET',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                response.json().then(data => {-->
<!--                    console.log('Cart data:', data);  // Logging the cart data-->
<!--                    const cartItems = document.getElementById('cartItems');-->
<!--                    cartItems.innerHTML = '';-->

<!--                    const items = data.Items || data.items;-->
<!--                    let grandTotal = 0; // Initialize the grand total-->

<!--                    if (items && Array.isArray(items)) {-->
<!--                        items.forEach(item => {-->
<!--                            const total = item.quantity * item.price;-->
<!--                            grandTotal += total; // Add to the grand total-->

<!--                            const row = document.createElement('tr');-->
<!--                            row.innerHTML = `-->
<!--                                <td>${item.product_id}</td>-->
<!--                                <td>${productNames[item.product_id]}</td>-->
<!--                                <td>${item.quantity}</td>-->
<!--                                <td>${item.price.toFixed(2)}</td>-->
<!--                                <td>${total.toFixed(2)}</td>-->
<!--                            `;-->
<!--                            cartItems.appendChild(row);-->
<!--                        });-->

<!--                        // Add a row for the grand total-->
<!--                        const totalRow = document.createElement('tr');-->
<!--                        totalRow.innerHTML = `-->
<!--                            <td colspan="4"><strong>Total</strong></td>-->
<!--                            <td><strong>${grandTotal.toFixed(2)}</strong></td>-->
<!--                        `;-->
<!--                        cartItems.appendChild(totalRow);-->
<!--                    } else {-->
<!--                        console.error('Unexpected cart data format:', data);-->
<!--                    }-->
<!--                });-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to fetch cart:', text);-->
<!--                    alert('Failed to fetch cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error fetching cart:', error);-->
<!--            alert('Failed to fetch cart: ' + error.message);-->
<!--        });-->
<!--    }-->

<!--    document.getElementById('clearCart').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for clearCart:', token);  // Logging the token-->

<!--        fetch('/api/cart/clear', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                console.log('Cart cleared!');-->
<!--                fetchCart(); // Refresh the cart after clearing-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to clear cart:', text);-->
<!--                    alert('Failed to clear cart: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error clearing cart:', error);-->
<!--            alert('Failed to clear cart: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('checkout').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for checkout:', token);  // Logging the token-->

<!--        fetch('/api/transaction/checkout', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                console.log('Checkout successful!');-->
<!--                fetchCart(); // Refresh the cart after checkout-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Checkout failed:', text);-->
<!--                    alert('Checkout failed: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error during checkout:', error);-->
<!--            alert('Checkout failed: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    document.getElementById('proceedToPayment').addEventListener('click', function() {-->
<!--        window.location.href = 'payment.html'; // Navigate to the payment page-->
<!--    });-->

<!--    document.getElementById('viewTransactions').addEventListener('click', function() {-->
<!--        window.location.href = 'transactions.html'; // Navigate to the transactions page-->
<!--    });-->

<!--    document.getElementById('deleteLastTransaction').addEventListener('click', function() {-->
<!--        const token = localStorage.getItem('token');-->
<!--        console.log('Token used for deleteLastTransaction:', token);  // Logging the token-->

<!--        fetch('/api/transaction/deleteLast', {-->
<!--            method: 'DELETE',-->
<!--            headers: {-->
<!--                'Authorization': 'Bearer ' + token-->
<!--            }-->
<!--        }).then(response => {-->
<!--            if (response.ok) {-->
<!--                console.log('Last transaction deleted!');-->
<!--            } else {-->
<!--                response.text().then(text => {-->
<!--                    console.error('Failed to delete last transaction:', text);-->
<!--                    alert('Failed to delete last transaction: ' + text);-->
<!--                });-->
<!--            }-->
<!--        }).catch(error => {-->
<!--            console.error('Error deleting last transaction:', error);-->
<!--            alert('Failed to delete last transaction: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--    window.onload = fetchCart;-->
<!--</script>-->

<!--</body>-->




<!--</html>-->



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(120deg, #70a4e1 0%, #2beec1 100%);
        }

        h1, h2 {
            color: #0a0000;
        }

        table {
            width: 100%;
            margin: 40px 0;
            border-collapse: collapse;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 15px;
            text-align: left;
        }

        th {
            background-color: #f8f8f8;
            font-weight: bold;
        }

        td {
            background-color: #fafafa;
        }

        .product-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .product {
            border: 1px solid #ddd;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 200px;
            border-radius: 5px;
        }

        .product img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
        }

        .product button, .product input {
            margin-top: 10px;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .product button {
            background-color: #28a745;
            color: white;
        }


        .product .confirm-btn {
            background-color: #007bff;
            color: white;
        }

        .product input {
            width: 60px;
            text-align: center;
        }

        .quantity-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .quantity-container input {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .cart-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .cart-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .cart-buttons button:hover {
            background-color: #0056b3;
        }

        .cart-buttons button:active {
            background-color: #003f7f;
        }

        .cart-buttons .clear-btn {
            background-color: #dc3545;
        }

        .cart-buttons .clear-btn:hover {
            background-color: #c82333;
        }

        .cart-buttons .clear-btn:active {
            background-color: #bd2130;
        }
    </style>
</head>
<body>
<h1>Shopping Cart</h1>

<!-- Product Images and Buttons -->
<h2>Products</h2>
<div class="product-container">
    <div class="product" data-product-id="1" data-product-name="Bread" data-product-price="110">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Assorted_bread.jpg/411px-Assorted_bread.jpg" alt="Bread">
        <div>Bread</div>
        <div class="quantity-container">
            <input type="number" min="1" value="1">
            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>
        </div>
    </div>
    <div class="product" data-product-id="2" data-product-name="Milk" data-product-price="165">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Glass_of_Milk_%2833657535532%29.jpg/411px-Glass_of_Milk_%2833657535532%29.jpg" alt="Milk">
        <div>Milk</div>
        <div class="quantity-container">
            <input type="number" min="1" value="1">
            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>
        </div>
    </div>
    <div class="product" data-product-id="3" data-product-name="Chocolate" data-product-price="320">
        <img src="https://static6.depositphotos.com/1098692/603/i/450/depositphotos_6033070-stock-photo-chocolate.jpg" alt="Chocolate">
        <div>Chocolate</div>
        <div class="quantity-container">
            <input type="number" min="1" value="1">
            <button class="confirm-btn" onclick="addToCart(this)">Add to Cart</button>
        </div>
    </div>
</div>

<!-- Display cart items -->
<h2>Cart Items</h2>
<div id="cart">
    <table>
        <thead>
        <tr>
            <th>Product ID</th>
            <th>Product Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Total</th>
        </tr>
        </thead>
        <tbody id="cartItems">
        <!-- Cart items will be appended here -->
        </tbody>
    </table>
</div>

<div class="cart-buttons">
    <button id="clearCart" class="clear-btn">Clear Cart</button>
    <button id="checkout" class="checkout-btn">Checkout</button>
    <button id="proceedToPayment" class="payment-btn">Proceed to Payment</button>
    <button id="deleteLastTransaction" class="transaction-btn">Delete Last Transaction</button>
    <button id="viewTransactions" class="transaction-btn">View Transactions</button>
</div>

<script>
    let cart = []; // Initialize an empty array to store cart items

    // Map to store product names by product ID
    const productNames = {
        1: "Bread",
        2: "Milk",
        3: "Chocolate"
    };

    function addToCart(button) {
        const productElement = button.closest('.product');
        const quantityInput = productElement.querySelector('input');
        const quantity = parseInt(quantityInput.value);

        const productId = productElement.getAttribute('data-product-id');
        const productName = productElement.getAttribute('data-product-name');
        const price = parseFloat(productElement.getAttribute('data-product-price'));

        // Add the product details to the cart array
        cart.push({
            product_id: productId,
            product_name: productName,
            quantity: quantity,
            price: price
        });

        updateCart(); // Update the cart visually

        const token = localStorage.getItem('token');
        console.log('Token used for addToCart:', token);  // Logging the token

        fetch('/api/cart/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + token
            },
            body: JSON.stringify({
                product_id: productId,
                quantity: quantity,
                price: price
            })
        }).then(response => {
            if (response.ok) {
                console.log('Product added to cart!');
                fetchCart(); // Refresh the cart after adding a product
            } else {
                response.text().then(text => {
                    console.error('Failed to add product to cart:', text);
                    alert('Failed to add product to cart: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error adding product to cart:', error);
            alert('Failed to add product to cart: ' + error.message);
        });
    }

    function updateCart() {
        const cartItems = document.getElementById('cartItems');
        cartItems.innerHTML = ''; // Clear the current cart items

        let grandTotal = 0; // Initialize the grand total

        cart.forEach(item => {
            const total = item.quantity * item.price;
            grandTotal += total; // Add to the grand total

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.product_id}</td>
                <td>${productNames[item.product_id]}</td>
                <td>${item.quantity}</td>
                <td>${item.price.toFixed(2)}</td>
                <td>${total.toFixed(2)}</td>
            `;
            cartItems.appendChild(row);
        });

        // Add a row for the grand total
        const totalRow = document.createElement('tr');
        totalRow.innerHTML = `
            <td colspan="4"><strong>Total</strong></td>
            <td><strong>${grandTotal.toFixed(2)}</strong></td>
        `;
        cartItems.appendChild(totalRow);
    }

    function fetchCart() {
        const token = localStorage.getItem('token');
        console.log('Token used for fetchCart:', token);  // Logging the token

        fetch('/api/cart', {
            method: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            }
        }).then(response => {
            if (response.ok) {
                response.json().then(data => {
                    console.log('Cart data:', data);  // Logging the cart data
                    const cartItems = document.getElementById('cartItems');
                    cartItems.innerHTML = '';

                    const items = data.Items || data.items;
                    let grandTotal = 0; // Initialize the grand total

                    if (items && Array.isArray(items)) {
                        items.forEach(item => {
                            const total = item.quantity * item.price;
                            grandTotal += total; // Add to the grand total

                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${item.product_id}</td>
                                <td>${productNames[item.product_id]}</td>
                                <td>${item.quantity}</td>
                                <td>${item.price.toFixed(2)}</td>
                                <td>${total.toFixed(2)}</td>
                            `;
                            cartItems.appendChild(row);
                        });

                        // Add a row for the grand total
                        const totalRow = document.createElement('tr');
                        totalRow.innerHTML = `
                            <td colspan="4"><strong>Total</strong></td>
                            <td><strong>${grandTotal.toFixed(2)}</strong></td>
                        `;
                        cartItems.appendChild(totalRow);
                    } else {
                        console.error('Unexpected cart data format:', data);
                    }
                });
            } else {
                response.text().then(text => {
                    console.error('Failed to fetch cart:', text);
                    alert('Failed to fetch cart: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error fetching cart:', error);
            alert('Failed to fetch cart: ' + error.message);
        });
    }

    document.getElementById('clearCart').addEventListener('click', function() {
        const token = localStorage.getItem('token');
        console.log('Token used for clearCart:', token);  // Logging the token

        fetch('/api/cart/clear', {
            method: 'DELETE',
            headers: {
                'Authorization': 'Bearer ' + token
            }
        }).then(response => {
            if (response.ok) {
                console.log('Cart cleared!');
                fetchCart(); // Refresh the cart after clearing
            } else {
                response.text().then(text => {
                    console.error('Failed to clear cart:', text);
                    alert('Failed to clear cart: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error clearing cart:', error);
            alert('Failed to clear cart: ' + error.message);
        });
    });

    document.getElementById('checkout').addEventListener('click', function() {
        const token = localStorage.getItem('token');
        console.log('Token used for checkout:', token);  // Logging the token

        fetch('/api/transaction/checkout', {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer ' + token
            }
        }).then(response => {
            if (response.ok) {
                console.log('Checkout successful!');
                fetchCart(); // Refresh the cart after checkout
            } else {
                response.text().then(text => {
                    console.error('Checkout failed:', text);
                    alert('Checkout failed: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error during checkout:', error);
            alert('Checkout failed: ' + error.message);
        });
    });

    document.getElementById('proceedToPayment').addEventListener('click', function() {
        window.location.href = 'payment.html'; // Navigate to the payment page
    });

    document.getElementById('viewTransactions').addEventListener('click', function() {
        window.location.href = 'transactions.html'; // Navigate to the transactions page
    });

    document.getElementById('deleteLastTransaction').addEventListener('click', function() {
        const token = localStorage.getItem('token');
        console.log('Token used for deleteLastTransaction:', token);  // Logging the token

        fetch('/api/transaction/deleteLast', {
            method: 'DELETE',
            headers: {
                'Authorization': 'Bearer ' + token
            }
        }).then(response => {
            if (response.ok) {
                console.log('Last transaction deleted!');
            } else {
                response.text().then(text => {
                    console.error('Failed to delete last transaction:', text);
                    alert('Failed to delete last transaction: ' + text);
                });
            }
        }).catch(error => {
            console.error('Error deleting last transaction:', error);
            alert('Failed to delete last transaction: ' + error.message);
        });
    });

    window.onload = fetchCart;
</script>

</body>
</html>
